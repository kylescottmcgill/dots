#!/bin/bash

PID=$$
trap 'exit 0' TERM SIGKILL
set +m

MONITOR=$(xrandr -q | awk -F'current' -F',' 'NR==1 {gsub("( |current)","");print $2}' | cut -f1 -d"x")
EXTERNAL=$(xrandr -q | grep -w "connected" | wc -l)
PANEL_FONT="tewi-8"

{
	if [[ $EXTERNAL -eq "2" ]]; then
		PANEL_SIZE="$MONITORx20+1920+10"
	else
		PANEL_SIZE="$MONITORx20+0+10"
	fi
}

PANEL_BG="#00FFFFFF"
PANEL_FG="#000000"
PANEL_UNDERLINE="#924445"

BG="#FFFFFF"
FG="#000000"

RED="#924445"

FONT="tewi-8"
TIMER=30

(echo "%{B$BG}%{c} %{A:pkill -SIGKILL -P $PID:} $PID %{F$RED}$1%{F-} $2 %{A}"; sleep $TIMER) | \
	lemonbar -d -f ${PANEL_FONT} -g ${PANEL_SIZE} -B ${PANEL_BG} -F ${PANEL_FG} -U ${PANEL_UNDERLINE} | sh 2>/dev/null
